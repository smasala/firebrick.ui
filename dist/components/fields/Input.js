/*!
 * @author Steven Masala [me@smasala.com]
 */

define(["text!./Base.html","text!./Input.html","../common/Base","x-editable","knockout-x-editable","../common/mixins/Items"],function(e,t){return Firebrick.define("Firebrick.ui.fields.Input",{extend:"Firebrick.ui.common.Base",mixins:["Firebrick.ui.common.mixins.Items"],uiName:"fb-ui-input",subTpl:t,type:"text",label:"",value:null,tpl:e,formGroupClass:"form-group",formControlClass:"form-control",colLabelSize:3,inputWidth:9,deviceSize:"sm",hideLabel:!1,readOnly:!1,disabled:!1,inputSize:!1,controlLabel:!0,helpText:!1,helpBlockClass:"help-block",placeholder:"",showStateIcon:!1,formControlFeedbackClass:"form-control-feedback",inputAddon:!1,inputAddonClass:"input-group-addon",inputAddonSpanClass:"",horizontal:!0,feedbackSuccess:!1,feedbackWarning:!1,feedbackError:!1,multiplesInline:!1,inplaceEdit:!1,showInplaceTitle:!0,required:!1,name:"",inputAddonPosition:"left",_inputAddonTplId:null,iconClass:!1,init:function(){var e=this;return e.required&&e.on("rendered",function(){e.onChange()}),e.callParent(arguments)},onChange:function(){var e=this,t=e.getElement(),n;e.required&&t&&t.length&&t.change(function(){n=t.closest(".form-group"),n.length&&(t.is(":invalid")?e.setStatus("error",n):e.setStatus("success",n))})},setStatus:function(e,t){var n=this,r=t||n.getElement();return r&&r.length&&e&&(r.attr("class",function(e,t){return t=t.replace(/(^|\s)has-\S+/g,""),t+=" has-feedback",t}),r.addClass("has-"+e)),n},containerBindings:function(){var e=this,t={css:{"'has-success'":e.feedbackSuccess,"'has-warning'":e.feedbackWarning,"'has-error'":e.feedbackError,"'has-feedback'":e.feedbackSuccess||e.feedbackWarning||e.feedbackError,"'sr-only'":e.hideLabel}};return e.align&&(t.css[e.parseBind("pull-"+e.align)]=!0),this.inputSize&&(t.css[e.parseBind("form-group-"+e.inputSize)]=e.inputSize?!0:!1),t},helpBlockBindings:function(){var e=this;return{text:e.textBind(e.helpText)}},feedbackBindings:function(){var e=this,t={css:{}},n="'glyphicon-";return e.containerBindings&&e.containerBindings.css&&$.each(e.containerBindings.css,function(e,r){if(r)switch(e){case"'has-success'":t.css[n+"ok'"]=r;break;case"'has-warning'":t.css[n+"warning'"]=r;break;case"'has-error'":t.css[n+"remove'"]=r}}),t},bindings:function(){var e=this,t=e.parseBind(e.type),n=e.callParent(arguments);n.attr.disabled=e.disabled,n.attr.readonly=e.readOnly,n.attr.type=t,n.attr.name=e.name?e.parseBind(e.name):t,n.value!==null&&(n.value=e.value);if(e.inplaceEdit){n.editableOptions={},n.attr["'data-type'"]=e.dataType?e.parseBind(e.dataType):t,n.editable=e.value;if(e.showInplaceTitle||$.fn.editable.defaults.mode!=="inline")n.attr["'data-title'"]=e.textBind(e.dataTitle||e.label)}else e.formControlClass&&(n.css[e.parseBind(e.formControlClass)]=!0),n.attr.placeholder=e.textBind(e.placeholder);return e.required&&(n.attr.required=!0),n},inputAddonBindings:function(){var e=this,t={css:{}};return e.inputAddon&&($.isPlainObject(e.inputAddon)&&fb.ui.cmp.button&&e.inputAddon.uiName===fb.ui.cmp.button&&(e.inputAddonClass=e.inputAddonClass.replace("input-group-addon",""),e.inputAddonClass+=" input-group-btn"),t.css[e.parseBind(e.inputAddonClass)]=!0),t},inputAddonSpanBindings:function(){var e=this,t={css:{}};return e.inputAddon&&typeof e.inputAddon=="string"&&(t.text=e.textBind(e.inputAddon)),t.css[e.parseBind(e.glyphiconClass)]=!0,e.iconClass&&(t.css[e.parseBind(e.iconClass)]=!0),t},inputAddonTemplateBindings:function(){var e=this,t={template:e.parseBind(e.getAddonId()),data:"$data"};return t},getAddonId:function(){var e=this;return e._inputAddonTplId||(e._inputAddonTplId="fb-inputaddon-"+Firebrick.utils.uniqId()),e._inputAddonTplId},labelBindings:function(){var e=this,t={text:e.textBind(e.label),css:{"'control-label'":e.controlLabel}};return e.horizontal&&(t.css[e.parseBind("col-"+e.deviceSize+"-"+e.colLabelSize)]=e.horizontal),t},inputContainerBindings:function(){var e=this,t={css:{}};return e.horizontal&&(t.css[e.parseBind("col-"+e.deviceSize+"-"+e.inputWidth)]=e.horizontal),t},fieldBindings:function(){var e=this,t={css:{"'input-group'":e.inputAddon?!0:!1}};return e.align&&(t.css[e.parseBind("pull-"+e.align)]=!0),t}})});