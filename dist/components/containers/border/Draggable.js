/*!
 * @author Steven Masala [me@smasala.com]
 */

define(["jquery"],function(e){"use strict";e.fn.drags=function(t,n){var r,i,s,o,u,a=function(e,t){return t=t.toUpperCase(),e.type.indexOf("touch")>=0?e.originalEvent.targetTouches[0]["page"+t]:e["page"+t]};return t=t.toLowerCase(),n=e.extend({handle:""},n),n.handle===""?r=this:r=this.find(n.handle),r.prop("dragSet")===!0?r:(r.prop("dragSet",!0),r.on("mouseover",function(){var t=e(this);t.prop("dragDisabled")===!0?t.css("cursor","auto"):t.css("cursor","")}).on("mousedown touchstart",function(r){var f=n.handle?e(this).addClass("active-handle").parent().addClass("draggable"):e(this).addClass("draggable"),l=f.css("z-index"),c=f.outerHeight(),h=f.outerWidth(),p=f.offset().top+c-a(r,"y"),d=f.offset().left+h-a(r,"x"),v;s=a(r,"y"),i=a(r,"x"),v=function(e){o=(t==="horizontal"?s:a(e,"y"))+p-c,u=(t==="vertical"?i:a(e,"x"))+d-h,f.offset({top:o,left:u})},f.on("mouseup touchend",function(){f.removeClass("draggable").css("z-index",l),e("html").off("mousemove touchmove","body",v)}),f.prop("dragDisabled")===!0?e("html").off("mousemove touchmove","body",v):(f.css("z-index",1e3),e("html").on("mousemove touchmove","body",v)),r.preventDefault()}).on("mouseup touchend",function(){var t=e(this);t.prop("dragDisabled")!==!0&&(n.handle===""?t.removeClass("draggable"):t.removeClass("active-handle").parent().removeClass("draggable"),t.trigger("dragged",[o-s,u-i]),t.css({top:0,left:0}))}))}});