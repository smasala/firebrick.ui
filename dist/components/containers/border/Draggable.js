/*!
 * @author Steven Masala [me@smasala.com]
 */

define(["jquery"],function(e){e.fn.drags=function(t,n){var r,i,s,o,u;return t=t.toLowerCase(),n=e.extend({handle:""},n),n.handle===""?r=this:r=this.find(n.handle),r.prop("dragSet")===!0?r:(r.prop("dragSet",!0),r.on("mouseover",function(){var t=e(this);t.prop("dragDisabled")===!0?t.css("cursor","auto"):t.css("cursor","")}).on("mousedown",function(r){var a=n.handle?e(this).addClass("active-handle").parent().addClass("draggable"):e(this).addClass("draggable"),f=a.css("z-index"),l=a.outerHeight(),c=a.outerWidth(),h=a.offset().top+l-r.pageY,p=a.offset().left+c-r.pageX,d;s=r.pageY,i=r.pageX,d=function(e){o=(t==="horizontal"?s:e.pageY)+h-l,u=(t==="vertical"?i:e.pageX)+p-c,a.offset({top:o,left:u})},a.on("mouseup",function(){a.removeClass("draggable").css("z-index",f),e("html").off("mousemove","body",d)}),a.prop("dragDisabled")===!0?e("html").off("mousemove","body",d):(a.css("z-index",1e3),e("html").on("mousemove","body",d)),r.preventDefault()}).on("mouseup",function(){var t=e(this);t.prop("dragDisabled")!==!0&&(n.handle===""?t.removeClass("draggable"):t.removeClass("active-handle").parent().removeClass("draggable"),t.trigger("dragged",[o-s,u-i]),t.css({top:0,left:0}))}))}});