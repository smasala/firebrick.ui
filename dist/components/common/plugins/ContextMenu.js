/*!
 * @author Steven Masala [me@smasala.com]
 */

(function(e){typeof define=="function"&&define.amd?define(["jquery","text!./ContextMenu.html","../mixins/Items"],e):e(window.jQuery)})(function(e,t){Firebrick.define("Firebrick.ui.common.plugins.ContextMenu",{extend:"Firebrick.ui.common.Base",mixins:"Firebrick.ui.common.mixins.Items",target:"body",tpl:t,enclosedBind:!0,appendTarget:!0,contextMenuEvent:null,init:function(){var t=this;return t.on("rendered",function(){var n=t.getElement(),r=t.contextMenuEvent,i=e(r.target),s=i.css("z-index"),o;typeof s=="string"?o=1:o=s+1,n.css({position:"absolute","z-index":o,top:r.clientY,left:r.clientX,display:"block"})}),t.callParent(arguments)},bindings:function(){var e=this,t=e.callParent(arguments);return t.css["'fb-ui-contextmenu'"]=!0,t.css["'dropdown-menu'"]=!0,t.style=t.style||{},t.style.display="'block'",t.attr.role="'menu'",t}}),e.fn.ContextMenu=function(t){var n=e(this);n.on("contextmenu",function(n){var r,i=function(t){var n=e(t.target),s=r.getElement();!s.is(n)&&!s.has(n).length&&(r.destroy(),e(document).off("click",i))};n.preventDefault(),r=Firebrick.create("Firebrick.ui.common.plugins.ContextMenu",{contextMenuEvent:n,items:t.contextMenu}),e(document).on("click",i)})}});