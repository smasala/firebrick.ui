/*!
* Firebrick UI
* @author Steven Masala [me@smasala.com]
* 
* FirebrickUI, component library for Firebrick JS
**/

(function(e,t){if(typeof define!="function"||!define.amd)return t(e.jQuery,e.Firebrick,e.ko);define(["jquery","firebrick","knockout","devicejs","knockout-mapping","text"],function(e,n,r,i,s,o){return r.mapping=s,t(e,n,r,i)})})(this,function(e,t,n,r){if(!t){console.error("Firebrick has not been loaded, Firebrick-UI requires Firebrick JS to function");return}if(t.ui){console.error("Firebrick.ui namespace has already been taken!");return}t.ui={version:"0.15.0",build:function(e){var n=this,r=t.views.getTarget(e.target),i,s;return i=n._populate(e.items,e.view),s=i.html,e.view&&i.items.length&&(e.view.items=i.items),r&&r.append(s),s},_populate:function(n,r){var i=this,s=[],o="",u;e.isFunction(n)&&(n=n()),!e.isArray(n)&&n&&(n=[n]);if(e.isArray(n)&&n.length){if(r.defaults){t.utils.merge("defaults",r);for(var a=0,f=n.length;a<f;a++)n[a]=t.utils.copyover(n[a],r.defaults)}for(var a=0,f=n.length;a<f;a++)u=i._buildComponent(n[a],r),o+=u._html,u.getId||console.error("something went wrong",n[a],"is it defined correctly? Check the item name and dependency include"),u.fireEvent("uiBuilt"),s.push(u)}return{html:o,items:s}},_buildComponent:function(e,n){var r=this,i,s;return e.isView?(e._state!=="initial"&&(i=e.init()),i=e):e.viewName?i=t.create(e.viewName,e):(e=r._componentFilter(e),e.uiComponent?i=e:(s=t.get(e.sName||e),s||console.error("Has",e.sName||e,"been added as a dependency?"),i=t.create(s._classname,e.sName?Object.getPrototypeOf(Object.create(e)):null))),i._parent||(i._parent=n),i.build&&(i._html=i.build()),i},_componentFilter:function(e){if(typeof e=="string")switch(e){case"|":e="display.divider"}return e},getCmp:function(e){return t.getById(e)},get:function(e){return t.get(e)},utils:{_buildDotObj:function(e,t,n){var r=this,i=e.shift();return n=n||{},n[i]={},e.length?e[0]!==""?r._buildDotObj(e,t,n[i]):console.error("error building sName, found empty string",e,i,t):n[i]=t,n},isVisible:function(e,t){var n={offset:t.offset(),height:t.height(),width:t.width()},r={offset:e.offset(),height:e.height(),width:e.width()},i=function(e){return e>n.offset.top&&e<n.offset.left&&e<n.bottom?!0:!1};return n.bottom=n.offset.top+n.height,r.bottom=r.offset.top+r.height,i(r.offset.top)||i(r.offset.top+r.width)||i(r.bottom)||i(r.bottom+r.width)?!0:!1},getValue:function(t){return e.isFunction(t)?t():t},stringify:function(t){if(t){var n=function(t,r){var i=r?"":"{",s,o;for(s in t)t.hasOwnProperty(s)&&(o=t[s],e.isPlainObject(o)?i+=s+":"+n(o):i+=s+": "+o+",");return i=i.substr(-1)===","?i.substring(0,i.length-1):i,i+=r?"":"},",i};return n(t,!0)}return""}},helper:{tabBuilder:function(n){var r=t.getById(n),i=r.items;return e.isFunction(i)?"Firebrick.getById('"+n+"').items()":e.isArray(i)?"Firebrick.getById('"+n+"').items":i},optionString:function(t){var n=t.options;return e.isFunction(n)?"Firebrick.ui.getCmp('"+t.getId()+"').options()":e.isArray(n)?"Firebrick.ui.getCmp('"+t.getId()+"').options":n},linkBuilder:function(e){return e&&typeof e.link=="string"?e.link:"javascript:void(0)"},callFunction:function(e,n,r){var i=t.getById(e);i&&n&&i[n].apply(i,r)}},renderer:{_registry:{},add:function(e,t){var n=this;return n._registry[e]=t,n},get:function(t){var n=this;return e.isFunction(t)&&(t=t()),n._registry[t]}},_sNames:{"button.dropdown.list":{path:"Firebrick.ui/button/dropdown/List"},"button.button":{path:"Firebrick.ui/button/Button"},"button.buttongroup":{path:"Firebrick.ui/button/ButtonGroup"},"button.icon":{path:"Firebrick.ui/button/Icon"},"button.togglebutton":{path:"Firebrick.ui/button/ToggleButton"},"containers.border.pane":{path:"Firebrick.ui/containers/border/Pane"},"containers.tab.pane":{path:"Firebrick.ui/containers/tab/Pane"},"containers.accordion":{path:"Firebrick.ui/containers/Accordion"},"containers.borderlayout":{path:"Firebrick.ui/containers/BorderLayout"},"containers.box":{path:"Firebrick.ui/containers/Box"},"containers.form":{path:"Firebrick.ui/containers/Form"},"containers.formpanel":{path:"Firebrick.ui/containers/FormPanel"},"containers.gridcolumn":{path:"Firebrick.ui/containers/GridColumn"},"containers.gridrow":{path:"Firebrick.ui/containers/GridRow"},"containers.modal":{path:"Firebrick.ui/containers/Modal"},"containers.fieldset":{path:"Firebrick.ui/containers/Fieldset"},"containers.panel":{path:"Firebrick.ui/containers/Panel"},"containers.tabpanel":{path:"Firebrick.ui/containers/TabPanel"},"display.alert":{path:"Firebrick.ui/display/Alert"},"display.divider":{path:"Firebrick.ui/display/Divider"},"display.header":{path:"Firebrick.ui/display/Header"},"display.image":{path:"Firebrick.ui/display/Image"},"display.list":{path:"Firebrick.ui/display/List"},"display.progress":{path:"Firebrick.ui/display/Progress"},"display.span":{path:"Firebrick.ui/display/Span"},"display.text":{path:"Firebrick.ui/display/Text"},"display.loader":{path:"Firebrick.ui/display/Loader"},"fields.checkbox":{path:"Firebrick.ui/fields/Checkbox"},"fields.datepicker":{path:"Firebrick.ui/fields/DatePicker"},"fields.display":{path:"Firebrick.ui/fields/Display"},"fields.combobox":{path:"Firebrick.ui/fields/ComboBox"},"fields.email":{path:"Firebrick.ui/fields/Email"},"fields.file":{path:"Firebrick.ui/fields/File"},"fields.input":{path:"Firebrick.ui/fields/Input"},"fields.password":{path:"Firebrick.ui/fields/Password"},"fields.radio":{path:"Firebrick.ui/fields/Radio"},"fields.selectbox":{path:"Firebrick.ui/fields/SelectBox"},"fields.textarea":{path:"Firebrick.ui/fields/TextArea"},"nav.breadcrumbs":{path:"Firebrick.ui/nav/Breadcrumbs"},"nav.list":{path:"Firebrick.ui/nav/List"},"nav.navbar":{path:"Firebrick.ui/nav/Navbar"},"nav.pagination":{path:"Firebrick.ui/nav/Pagination"},"nav.toolbar":{path:"Firebrick.ui/nav/Toolbar"},"table.table":{path:"Firebrick.ui/table/Table"},"table.treetable":{path:"Firebrick.ui/table/TreeTable"}}},t.classes.addSNames(t.ui._sNames),t.classes.overwrite("Firebrick.view.Base",{_ko:null,passDownEvents:{rendered:1,htmlRendered:1,unbound:1,destroy:1},listeners:{uiBuilt:function(){var e=this,n;if(e.passDownEvents){t.utils.merge("passDownEvents",e);for(n in e.passDownEvents)e.passDownEvents.hasOwnProperty(n)&&e._parent&&e._initPassDownEvent(n)}}},_initPassDownEvent:function(e){var t=this,n=t._createPassEvent(t);t._parent.on(e,n),t.on("destroy",function(){n.__isDestroyed=!0})},_createPassEvent:function(e){return function(){var t=this,n=Array.prototype.slice.call(arguments);n=[t.event.eventName].concat(n),e.fireEvent.apply(e,n)}},items:null,tpl:function(){var e=this;if(e.items)return t.ui.build({items:e.items,view:e})}}),n.bindingHandlers.withProperties={init:function(e,t,r,i,s){var o=s.createChildContext(s.$rawData,null,function(e){n.utils.extend(e,t())});return n.applyBindingsToDescendants(o,e),{controlsDescendantBindings:!0}}},n.bindingHandlers.debug={init:function(e,t,n,r,i){console.warn("Debug:",e,t(),n(),r,i)}};var i=n.bindingHandlers.value.init;n.bindingHandlers.value.init=function(e,n,r,s,o){var u=t.getById(e.getAttribute("id"));return u&&(u._ko=u._ko||{},u._ko.value={element:e,valueAccessor:n,allBindings:r,viewModel:s,bindingContext:o}),i.apply(this,arguments)};var s=n.bindingHandlers.selectedOptions.init;n.bindingHandlers.selectedOptions.init=function(e,n,r,i,o){var u=t.getById(e.getAttribute("id"));return u&&(u._ko=u._ko||{},u._ko.selectedOptions={element:e,valueAccessor:n,allBindings:r,viewModel:i,bindingContext:o}),s.apply(this,arguments)}});