/*!
* Firebrick UI
* @author Steven Masala [me@smasala.com]
* 
* FirebrickUI, component library for Firebrick JS
**/

(function(e,t){if(typeof define!="function"||!define.amd)return t(e.jQuery,e.Firebrick,e.ko);define(["jquery","firebrick","knockout","knockout-mapping","text"],function(e,n,r,i,s,o){return r.mapping=i,t(e,n,r,o)})})(this,function(e,t,n){if(!t){console.error("Firebrick has not been loaded, Firebrick-UI requires Firebrick JS to function");return}if(t.ui){console.error("Firebrick.ui namespace has already been taken!");return}t.ui={version:"0.9.7",_searchCache:{},build:function(e){var n=this,r=t.views.getTarget(e.target),i,s;return i=n._populate(e.items,e.view),s=i.html,e.view&&i.items.length&&(e.view.items=i.items),r&&r.append(s),s},cmp:{},i:0,_populate:function(n,r){var i=this,s=[],o="",u,a;e.isFunction(n)&&(n=n());var f;for(var l=0,c=n.length;l<c;l++)f=n[l],f.isView?(f._state==="initial"&&(u=f.init()),o+=u.tpl):f.viewName?(u=t.create(f.viewName,f),o+=u.tpl):(f.uiComponent?u=f:(a=i.getByShortName(f.uiName||f),u=t.create(a._classname,f.uiName?Object.getPrototypeOf(Object.create(f)):null)),u._parent=r,o+=u.build()),u._parent||(u._parent=r),s.push(u);return{html:o,items:s}},getByShortName:function(e){var n=this,r=n._searchCache[e];if(!r){var i,s;for(i in t.classes.classRegistry)if(t.classes.classRegistry.hasOwnProperty(i)){s=t.classes.classRegistry[i];if(s.uiComponent&&s.uiName===e){r=s,n._searchCache[e]=s;break}}}return r||console.error("ui component",e,"not found"),r},get:function(e){return t.get(e)},utils:{stringify:function(t){if(t){var n=function(t,r){var i=r?"":"{",s,o;for(s in t)t.hasOwnProperty(s)&&(o=t[s],e.isPlainObject(o)?i+=s+":"+n(o):i+=s+": "+o+",");return i=i.substr(-1)===","?i.substring(0,i.length-1):i,i+=r?"":"},",i};return n(t,!0)}return""}},renderer:{_registry:{},add:function(e,t){var n=this;return n._registry[e]=t,n},get:function(e){var t=this;return t._registry[e]}}},t.classes.overwrite("Firebrick.view.Base",{listeners:{rendered:function(){var t=this;if(e.isArray(t.items))for(var n=0,r=t.items.length;n<r;n++)t.items[n].fireEvent("rendered")}},items:null,tpl:function(){var e=this;if(e.items)return t.ui.build({items:e.items,view:e})}}),n.bindingHandlers.withProperties={init:function(e,t,r,i,s){var o=s.extend(t);return n.applyBindingsToDescendants(o,e),{controlsDescendantBindings:!0}}}});