<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src\components\fields\ComboBox.js - Firebrick UI API</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="..\fbui_small.png" title="Firebrick UI API"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.20.17</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/components.button.Button.html">components.button.Button</a></li>
            
                <li><a href="../classes/components.button.ButtonGroup.html">components.button.ButtonGroup</a></li>
            
                <li><a href="../classes/components.button.components.common.mixins.Items.html">components.button.components.common.mixins.Items</a></li>
            
                <li><a href="../classes/components.button.components.common.MultiplesBase.html">components.button.components.common.MultiplesBase</a></li>
            
                <li><a href="../classes/components.button.components.menu.Menu.html">components.button.components.menu.Menu</a></li>
            
                <li><a href="../classes/components.common.components.fields.Input.html">components.common.components.fields.Input</a></li>
            
                <li><a href="../classes/components.common.mixins.components.button.ButtonGroupBase.html">components.common.mixins.components.button.ButtonGroupBase</a></li>
            
                <li><a href="../classes/components.common.mixins.components.button.ToggleButton.html">components.common.mixins.components.button.ToggleButton</a></li>
            
                <li><a href="../classes/components.common.mixins.components.common.Base.html">components.common.mixins.components.common.Base</a></li>
            
                <li><a href="../classes/components.common.mixins.components.containers.Base.html">components.common.mixins.components.containers.Base</a></li>
            
                <li><a href="../classes/components.common.mixins.components.nav.Toolbar.html">components.common.mixins.components.nav.Toolbar</a></li>
            
                <li><a href="../classes/components.common.view.Base.html">components.common.view.Base</a></li>
            
                <li><a href="../classes/components.containers.border.Pane.html">components.containers.border.Pane</a></li>
            
                <li><a href="../classes/components.containers.border.plugins.Draggable.html">components.containers.border.plugins.Draggable</a></li>
            
                <li><a href="../classes/components.containers.BorderLayout.html">components.containers.BorderLayout</a></li>
            
                <li><a href="../classes/components.containers.components.common.mixins.Column.html">components.containers.components.common.mixins.Column</a></li>
            
                <li><a href="../classes/components.containers.components.common.mixins.Toolbars.html">components.containers.components.common.mixins.Toolbars</a></li>
            
                <li><a href="../classes/components.containers.components.fields.Base.html">components.containers.components.fields.Base</a></li>
            
                <li><a href="../classes/components.containers.Fieldset.html">components.containers.Fieldset</a></li>
            
                <li><a href="../classes/components.containers.Form.html">components.containers.Form</a></li>
            
                <li><a href="../classes/components.containers.FormPanel.html">components.containers.FormPanel</a></li>
            
                <li><a href="../classes/components.containers.GridColumn.html">components.containers.GridColumn</a></li>
            
                <li><a href="../classes/components.containers.GridRow.html">components.containers.GridRow</a></li>
            
                <li><a href="../classes/components.containers.Panel.html">components.containers.Panel</a></li>
            
                <li><a href="../classes/components.containers.tab.components.containers.Modal.html">components.containers.tab.components.containers.Modal</a></li>
            
                <li><a href="../classes/components.containers.tab.Pane.html">components.containers.tab.Pane</a></li>
            
                <li><a href="../classes/components.display.Alert.html">components.display.Alert</a></li>
            
                <li><a href="../classes/components.display.components.containers.TabPanel.html">components.display.components.containers.TabPanel</a></li>
            
                <li><a href="../classes/components.display.components.nav.Base.html">components.display.components.nav.Base</a></li>
            
                <li><a href="../classes/components.display.Divider.html">components.display.Divider</a></li>
            
                <li><a href="../classes/components.display.Header.html">components.display.Header</a></li>
            
                <li><a href="../classes/components.display.Image.html">components.display.Image</a></li>
            
                <li><a href="../classes/components.display.Loader.html">components.display.Loader</a></li>
            
                <li><a href="../classes/components.display.Progress.html">components.display.Progress</a></li>
            
                <li><a href="../classes/components.display.Span.html">components.display.Span</a></li>
            
                <li><a href="../classes/components.fields.Checkbox.html">components.fields.Checkbox</a></li>
            
                <li><a href="../classes/components.fields.ComboBox.html">components.fields.ComboBox</a></li>
            
                <li><a href="../classes/components.fields.components.button.Icon.html">components.fields.components.button.Icon</a></li>
            
                <li><a href="../classes/components.fields.components.display.Text.html">components.fields.components.display.Text</a></li>
            
                <li><a href="../classes/components.fields.Datepicker.html">components.fields.Datepicker</a></li>
            
                <li><a href="../classes/components.fields.Display.html">components.fields.Display</a></li>
            
                <li><a href="../classes/components.fields.Email.html">components.fields.Email</a></li>
            
                <li><a href="../classes/components.fields.File.html">components.fields.File</a></li>
            
                <li><a href="../classes/components.fields.Hidden.html">components.fields.Hidden</a></li>
            
                <li><a href="../classes/components.fields.HtmlEditor.html">components.fields.HtmlEditor</a></li>
            
                <li><a href="../classes/components.fields.Password.html">components.fields.Password</a></li>
            
                <li><a href="../classes/components.fields.plugins.InplaceEdit.html">components.fields.plugins.InplaceEdit</a></li>
            
                <li><a href="../classes/components.fields.Radio.html">components.fields.Radio</a></li>
            
                <li><a href="../classes/components.fields.Suggest.html">components.fields.Suggest</a></li>
            
                <li><a href="../classes/components.fields.TextArea.html">components.fields.TextArea</a></li>
            
                <li><a href="../classes/components.menu.components.common.mixins.Badges.html">components.menu.components.common.mixins.Badges</a></li>
            
                <li><a href="../classes/components.menu.components.fields.SelectBox.html">components.menu.components.fields.SelectBox</a></li>
            
                <li><a href="../classes/components.menu.Item.html">components.menu.Item</a></li>
            
                <li><a href="../classes/components.nav.Breadcrumbs.html">components.nav.Breadcrumbs</a></li>
            
                <li><a href="../classes/components.nav.components.common.mixins.Label.html">components.nav.components.common.mixins.Label</a></li>
            
                <li><a href="../classes/components.nav.components.display.List.html">components.nav.components.display.List</a></li>
            
                <li><a href="../classes/components.nav.components.menu.ContextMenu.html">components.nav.components.menu.ContextMenu</a></li>
            
                <li><a href="../classes/components.nav.List.html">components.nav.List</a></li>
            
                <li><a href="../classes/components.nav.Navbar.html">components.nav.Navbar</a></li>
            
                <li><a href="../classes/components.table.plugins.EditableTable.html">components.table.plugins.EditableTable</a></li>
            
                <li><a href="../classes/components.table.Table.html">components.table.Table</a></li>
            
                <li><a href="../classes/components.table.TreeTable.html">components.table.TreeTable</a></li>
            
                <li><a href="../classes/helper.html">helper</a></li>
            
                <li><a href="../classes/KeyEvents.html">KeyEvents</a></li>
            
                <li><a href="../classes/plugins.components.containers.Accordion.html">plugins.components.containers.Accordion</a></li>
            
                <li><a href="../classes/plugins.components.containers.Box.html">plugins.components.containers.Box</a></li>
            
                <li><a href="../classes/plugins.components.nav.Pagination.html">plugins.components.nav.Pagination</a></li>
            
                <li><a href="../classes/renderer.html">renderer</a></li>
            
                <li><a href="../classes/ui.html">ui</a></li>
            
                <li><a href="../classes/utils.html">utils</a></li>
            
                <li><a href="../classes/view.Base.html">view.Base</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/Firebrick.engine.html">Firebrick.engine</a></li>
            
                <li><a href="../modules/Firebrick.ui.html">Firebrick.ui</a></li>
            
                <li><a href="../modules/Firebrick.ui.components.html">Firebrick.ui.components</a></li>
            
                <li><a href="../modules/plugins.html">plugins</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: src\components\fields\ComboBox.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/*!
 * @author Steven Masala [me@smasala.com]
 */

/**
 * @module Firebrick.ui.components
 * @extends components.fields.Input
 * @namespace components.fields
 * @class ComboBox
 */
define( [ &quot;text!./ComboBox.html&quot;,
        &quot;jquery&quot;,
        &quot;text!./combo/Item.html&quot;,
        &quot;text!./combo/Group.html&quot;,
        &quot;text!./combo/Value.html&quot;,
        &quot;doT&quot;,
        &quot;./Input&quot;,
        &quot;Firebrick.ui.engines/Suggest&quot;,
        &quot;../display/Loader&quot; ], function( subTpl, $, comboItemTpl, comboGroupTpl, valueItemTpl, tplEngine ) {
	&quot;use strict&quot;;
	
	return Firebrick.define( &quot;Firebrick.ui.fields.ComboBox&quot;, {
		extend: &quot;Firebrick.ui.fields.Input&quot;,
		/**
		 * @property sName
		 * @type {String}
		 */
		sName: &quot;fields.combobox&quot;,
		/**
		 * @property subTpl
		 * @type {String} html
		 */
		subTpl: subTpl,
		/**
		 * @property multiSelect
		 * @type {Boolean}
		 * @default false
		 */
		multiSelect: false,
		/**
		 * @property maxItems
		 * @type {Integer|false}
		 * @default false
		 */
		maxItems: false,
		/**
		 * forces the select of an item
		 * @property forceSelect
		 * @type {Boolean}
		 * @default false
		 */
		forceSelect: false,
		/**
		 * set typeahead to 0 to show result to on focus
		 * @property typeahead
		 * @type {Integer}
		 * @default 1
		 */
		typeahead: 1,
		/**
		 * @property store
		 * @default null
		 */
		store: null,
		/**
		 * @property itemTpl
		 * @type {String|Function}
		 */
		itemTpl: comboItemTpl,
		/**
		 * @property groupTpl
		 * @type {String|Function}
		 */
		groupTpl: comboGroupTpl,
		/**
		 * @property valueTpl
		 * @type {String|Function}
		 */
		valueTpl: valueItemTpl,
		/**
		 * used to store generated templates - performance - initialised by precompile()
		 * @property _itemTemplate
		 * @private
		 * @type {Object}
		 * @default null
		 */
		_itemTemplate: null,
		/**
		 * @property _resultsVisible
		 * @private
		 * @type {Boolean}
		 * @default false
		 */
		_resultsVisible: false,
		/**
		 * @property labelKey
		 * @type {String}
		 * @default &quot;text&quot;
		 */
		labelKey: &quot;text&quot;,
		/**
		 * @property valueKey
		 * @type {String}
		 * @default &quot;value&quot;
		 */
		valueKey: &quot;value&quot;,
		/**
		 * only set if needed different to labelKey
		 * @property groupLabelKey
		 * @type {String}
		 * @default null
		 */
		groupLabelKey: null,
		/**
		 * @property _valueEl
		 * @private
		 * @type {jQuery Object}
		 * @default null
		 */
		_valueEl: null,
		/**
		 * used to configure suggestion engine object hash
		 * @property suggest
		 * @type {Object}
		 * @default null
		 */
		suggest: null,
		/**
		 * property holder for suggestion engine after construction
		 * @property _engine
		 * @private
		 * @type {Object}
		 * @default null
		 */
		_engine: null,
		/**
		 * used on keydown and when search is performed to minimise searches to when the user has stopped typing
		 * @property _timestamp
		 * @private
		 * @type {Integer} timestamp
		 * @default null
		 */
		_timestamp: null,
		/**
		 * @method getValueEl
		 * @return {jQuery Object}
		 */
		getValueEl: function() {
			var me = this;
			if ( !me._valueEl ) {
				me._valueEl = $( &quot;&gt; .fb-ui-combo-values&quot;, me.getElement() );
			}
			return me._valueEl;
		},
		/**
		 * @property _inputEl
		 * @private
		 * @type {jQuery Object}
		 * @default null
		 */
		_inputEl: null,
		/**
		 * @method getInputEl
		 * @return {jQuery Object}
		 */
		getInputEl: function() {
			var me = this;
			if ( !me._inputEl ) {
				me._inputEl = $( &quot;&gt; input.fb-ui-combo-input&quot;, me.getElement() );
			}
			return me._inputEl;
		},
		/**
		 * @property showCaret
		 * @type {Boolean}
		 * @default true
		 */
		showCaret: true,
		/**
		 * @property _caretEl
		 * @private
		 * @type {jQuery Object}
		 * @default null
		 */
		_caretEl: null,
		/**
		 * @method getCaretEl
		 * @return {jQuery Object}
		 */
		getCaretEl: function() {
			var me = this;
			if ( !me._caretEl ) {
				me._caretEl = $( &quot;&gt; .fb-ui-combo-select&quot;, me.getElement() );
			}
			return me._caretEl;
		},
		/**
		 * @property _resultEl
		 * @private
		 * @type {jQuery Object}
		 * @default null
		 */
		_resultEl: null,
		/**
		 * @method getResultEl
		 * @return {jQuery Object}
		 */
		getResultEl: function() {
			var me = this;
			if ( !me._resultEl ) {
				me._resultEl = me.getElement().next( &quot;.fb-ui-combo-result[data-for=&#x27;&quot; + me.getId() + &quot;&#x27;]&quot; );
			}
			return me._resultEl;
		},
		/**
		 * @property _clearIcon
		 * @private
		 * @type {jQuery Object}
		 * @default null
		 */
		_clearIconEl: null,
		/**
		 * @method getClearIconEl
		 * @return {jQuery Object}
		 */
		getClearIconEl: function() {
			var me = this;
			if ( !me._clearIconEl ) {
				me._cleanIconEl = $( &quot;.fb-ui-combo-clear-icon&quot;, me.getElement() );
			}
			return me._cleanIconEl;
		},
		/**
		 * override base function
		 * @method focus
		 */
		focus: function() {
			this.getInputEl().focus();
		},
		/**
		 * @method init
		 */
		init: function() {
			var me = this;
			
			me._itemTemplate = {};
			
			me.on( &quot;rendered&quot;, function() {
				me._initSuggestionEngine();
				me._initRendered();
			});
			
			me.on( &quot;removeAll&quot;, function() {
				me.getClearIconEl().hide();
			});
			
			return me.callParent( arguments );
		},
		/**
		 * @method _initSuggestionEngine
		 */
		_initSuggestionEngine: function() {
			var me = this,
				conf = {
					store: me.store,
					filter: function( val ) {
						//used to exclude results from future selections - local mode
						return !val._exclude;
					}
				};
			
			conf = Firebrick.utils.overwrite( conf, ( me.suggest || {}) );
			
			me._engine = Firebrick.create( &quot;Firebrick.ui.engines.Suggest&quot;, conf );
		},
		/**
		 * @method _initRendered
		 * @private
		 */
		_initRendered: function() {
			var me = this,
				$el = me.getElement(),
				$input = me.getInputEl(),
				$result = me.getResultEl(),
				$clearIcon = me.getClearIconEl();
			
			$el.on({
				click: function() {
					return me._onClick.apply( me, arguments );
				}
			});
			
			$clearIcon.on({
				click: function() {
					return me._onClearIconClick.apply( me, arguments );
				}
			});

			$input.on( &quot;keydown keyup fb.update blur&quot;, function() {
				return me.resizeInput.apply( me, arguments );
			});
			
			$input.on({
				focus: function() {
					return me._onFocus.apply( me, arguments );
				},
				keydown: function() {
					return me._onKeyDown.apply( me, arguments );
				},
				keyup: function() {
					return me._onKeyUp.apply( me, arguments );
				},
				blur: function() {
					return me._onBlur.apply( me, arguments );
				}
			});
			
			$result.on( &quot;mousedown&quot;, &quot;.fb-ui-combo-item&quot;, function() {
				return me._onItemClick.apply( me, arguments );
			});
			
			$result.on( &quot;mouseover&quot;, &quot;.fb-ui-combo-item&quot;, function() {
				return me._onMouseOver.apply( me, arguments );
			});
			
			if ( me.multiSelect ) {
				$el.on( &quot;click&quot;, &quot;.fb-ui-combo-value-item&quot;, function() {
					return me.removeItem( $( this ) );
				});
			}
			
			me.on({
				expand: function() {
					var me = this,
						$el = me.getElement(),
						$result = me.getResultEl(),
						$active = me.getActiveItem(),
						$first;
					
					$el.addClass( &quot;open&quot; );
					
					if ( me.forceSelect &amp;&amp; !$active.length ) {
						$first = $( &quot;.fb-ui-combo-item:first-child&quot;, $result );
						if ( $first.length ) {
							me.markActive( $first );
						}
					}
					
				},
				collapse: function() {
					me.resultDefaults();
				}
			});
		},
		/**
		 * default actions on results expand/collapse
		 * @method resultsDefault
		 */
		resultDefaults: function() {
			var me = this,
				$el = me.getElement();
			
			$el.removeClass( &quot;open&quot; );
		},
		/**
		 * @method onFocus
		 * @private
		 */
		_onFocus: function() {
			var me = this;
			
			me.showResults();
			
			if ( me.getValue().length ) {
				me.getClearIconEl().show();
			}
			
		},
		/**
		 * @method _onClick
		 * @private
		 */
		_onClick: function() {
			var me = this,
				$input = me.getInputEl();
			$input.focus();
		},
		/**
		 * @method _onClearIconClick
		 * @private
		 */
		_onClearIconClick: function() {
			this.removeAll();
		},
		/**
		 * @method _onItemClick
		 * @private
		 */
		_onItemClick: function() {
			var me = this;
			me.selectActive();
		},
		/**
		 * @method _onMouseOver
		 * @private
		 */
		_onMouseOver: function( event ) {
			var me = this,
				clazz = &quot;fb-ui-combo-item&quot;,
				selector = &quot;.&quot; + clazz,
				$item = $( event.target );
			
				if ( !$item.hasClass( clazz ) ) {
					$item = $item.parent( selector );
				}
			
				me.markActive( $item );
		},
		/**
		 * @method onKeyDown
		 * @private
		 */
		_onKeyDown: function( event ) {
			var me = this,
				key = event.which,
				KeyEvent = Firebrick.ui.KeyEvents,
				$input = me.getInputEl();
			
			if ( key === KeyEvent.DOM_VK_RETURN ) {
				event.preventDefault();
			} else if ( key === KeyEvent.DOM_VK_BACK_SPACE ) {
				if ( !$input.val() ) {
					me.removeLastItem();
				}
			}
			
			me._arrowKey( key );
			
			me._timestamp = new Date().getTime();
		},
		/**
		 * @method _onKeyUp
		 * @private
		 */
		_onKeyUp: function( event ) {
			var me = this,
				key = event.which,
				KeyEvent = Firebrick.ui.KeyEvents,
				$input = me.getInputEl();
			
			if ( !me.actionKey( key ) ) {
				if ( $input.val().trim() ) {
					
					Firebrick.delay(function() {
						var t = new Date().getTime();
						if ( ( t - me._timestamp ) &gt;= 300 ) {
							me._timestamp = t;
							me.showResults();
						}
					}, 301 );
					
				} else {
					me.hideResults();
				}
			} else {
				if ( key === KeyEvent.DOM_VK_RETURN ) {
					event.preventDefault();
					me.selectActive();
				} else if ( key === KeyEvent.DOM_VK_DOWN ) {
					if ( !$input.val() ) {
						//show all
						if ( !me._resultsVisible ) {
							me.showResults();
						}
					}
				}
			}
			
		},
		/**
		 * @method _onBlur
		 * @private
		 */
		_onBlur: function() {
			var me = this;
			if ( me.forceSelect ) {
				//TODO: only if no value already set
				if ( !me.getValue().length ) {
					me.selectActive();
				}
			}
			Firebrick.delay(function() {
				me.getClearIconEl().hide();
			}, 200 );
			me.hideResults();
		},
		/**
		 * @method reset
		 */
		reset: function() {
			var me = this;
			me.hideResults();
			me.clearInput();
		},
		/**
		 * @method resizeInput
		 */
		resizeInput: function() {
			var me = this,
				$input = me.getInputEl(),
				currentWidth = $input.width(),
				width = me._measureWidth( $input ) + 8;
			if ( width !== currentWidth ) {
				$input.width( width );
			}
		},
		/**
		 * @method _measureWidth
		 * @private
		 * @return {Integer}
		 */
		_measureWidth: function( $input ) {
			var $tmp = $( &quot;&lt;tmp&gt;&quot; ).css({
					position: &quot;absolute&quot;,
					top: -99999,
					left: -99999,
					width: &quot;auto&quot;,
					padding: 0,
					whiteSpace: &quot;pre&quot;
				}).text( $input.val() ).appendTo( &quot;body&quot; ),
				styles = [ &quot;letterSpacing&quot;,
				&quot;fontSize&quot;,
				&quot;fontFamily&quot;,
				&quot;fontWeight&quot;,
				&quot;textTransform&quot; ],
				style,
				copiedStyles = {},
				width;
			
			for ( var i = 0, l = styles.length; i &lt; l; i++ ) {
				style = styles[ i ];
				copiedStyles[ style ] = $input.css( style );
			}
			
			$tmp.css( copiedStyles );
			width = $tmp.width();
			$tmp.remove();
			return width;
		},
		/**
		 * @method actionKey
		 * @return {Boolean}
		 */
		actionKey: function( keyCode ) {
			var KeyEvent = Firebrick.ui.KeyEvents;
			
			if (	keyCode === KeyEvent.DOM_VK_DOWN ||
				keyCode === KeyEvent.DOM_VK_UP ||
				keyCode === KeyEvent.DOM_VK_RETURN ) {
				return true;
			}
			
			return false;
		},
		/**
		 * @method getActiveItem
		 * @return {jQuery Object}
		 */
		getActiveItem: function() {
			var me = this,
				$item = $( &quot;.fb-ui-combo-item.active&quot;, me.getResultEl() );
			return $item;
		},
		
		/**
		 * @method markActive
		 * @param $item {jQuery Object}
		 */
		markActive: function( $item ) {
			var me = this,
				$active = me.getActiveItem();
			if ( $item.length ) {
				$active.removeClass( &quot;active&quot; );
				$item.addClass( &quot;active&quot; );
				$item.focus();
			}
		},
		/**
		 * @method selectActive
		 * @param $item {jQuery Object} optional
		 */
		selectActive: function( $item ) {
			var me = this,
				$active = $item || me.getActiveItem(),
				data = {},
				values = [];
					
			if ( $active.length ) {

				data = $active.prop( &quot;data-value&quot; );
				
				//exclude result from future searches
				data._exclude = true;
				
				values.push( data );

				me.setValue( values );
				
				if ( values.length ) {
					me.getClearIconEl().show();
				}
			}
			
		},
		/**
		 * @event removeAll
		 * @method removeAll
		 */
		removeAll: function() {
			var me = this,
				oldValue = me.getValue(),
				$items = $( &quot;.fb-ui-combo-value-item&quot;, me.getValueEl() );
			
			for ( var i = 0, l = $items.length; i &lt; l; i++ ) {
				//remove exclude filter on all items
				$( $items[ 0 ] ).prop( &quot;data-value&quot; )._exclude = false;
			}
			
			$items.remove();
			me._checkChange( me.getValue(), oldValue );
			me.fireEvent( &quot;removeAll&quot; );
		},
		/**
		 * @event removeItem
		 * @method removeItem
		 * @param $item {jQuery Item}
		 */
		removeItem: function( $item ) {
			var me = this,
				oldValue = me.getValue(),
				data = $item.prop( &quot;data-value&quot; );
			data._exclude = false;
			$item.remove();
			me._checkChange( me.getValue(), oldValue );
			me.on( &quot;removeItem&quot; );
		},
		/**
		 * @method removeLastItem
		 */
		removeLastItem: function() {
			var me = this,
				$items = $( &quot;.fb-ui-combo-value-item&quot;, me.getValueEl() ),
				$last = $items.last();
			
			if ( $items.length === 1 &amp;&amp; me.forceSelect ) {
				return;
			}
			
			if ( $last.length ) {
				me.removeItem( $last );
			}
		},
		/**
		 * @method clearInput
		 */
		clearInput: function() {
			var me = this,
				$input = me.getInputEl();
			
			$input.val( &quot;&quot; );
		},
		/**
		 * @method _arrowKey
		 * @private
		 * @return boolean
		 */
		_arrowKey: function( keyCode ) {
			var me = this,
				keyboard = Firebrick.ui.KeyEvents,
				selector = &quot;.fb-ui-combo-item&quot;,
				groupSelector = &quot;.fb-ui-combo-group-item&quot;,
				$result = me.getResultEl(),
				$active = $( selector + &quot;.active&quot;, $result ),
				$sibling;
			
			if ( me._resultsVisible ) {
				
				//only on up and down actions
				if ( keyCode === keyboard.DOM_VK_DOWN || keyCode === keyboard.DOM_VK_UP ) {
					
					if ( $active.length ) {
						
						if ( keyCode === keyboard.DOM_VK_DOWN ) {
							$sibling = $active.next();
							if ( !$sibling.length ) {
								$sibling = $active.closest( groupSelector ).next();
							}
						} else {
							$sibling = $active.prev();
							if ( !$sibling.length ) {
								$sibling = $active.closest( groupSelector ).prev();
							}
						}
						
						//check if sibling is another group
						if ( $sibling.is( groupSelector ) ) {
							//find appropriate sibling in group
							if ( keyCode === keyboard.DOM_VK_DOWN ) {
								$sibling = $sibling.find( selector ).first();
							} else {
								$sibling = $sibling.find( selector ).last();
							}
						}
						
						me.markActive( $sibling );
						me._scrollOnKey( keyCode, $sibling, $result );
						
					} else {
						me.markActive( $result.find( &quot;.fb-ui-combo-item&quot; ).first() );
					}
					
					return true;
				}
				
			}
			
			return false;
		},
		/**
		 * return items which is currently highlighted in the dopwdown
		 * @method getSelection
		 * @return {jQuery Object | null}
		 */
		getSelection: function() {
			var me = this,
				$result = me.getResultEl();
			if ( me._resultsVisible ) {
				return $( &quot;.fb-ui-combo-item.active&quot;, $result );
			}
		},
		/**
		 * @method _scollOnKey
		 * @param keycode {Integer}
		 * @param $target {jQuery Object}
		 * @param $container {jQuery Object}
		 */
		_scrollOnKey: function( keycode, $target, $container ) {
			var sibTop,
				sibBottom,
				KeyEvent = Firebrick.ui.KeyEvents,
				resTop = $container.offset().top,
				resHeight = $container.height(),
				resBottom = resTop + resHeight,
				scrollTo = null;
			
			if ( $target.length ) {
				if ( keycode === KeyEvent.DOM_VK_DOWN ) {
					sibBottom = $target.offset().top + $target.outerHeight();
					if ( sibBottom &gt; resBottom ) {
						scrollTo = ( $container.scrollTop() + sibBottom ) - resTop - resHeight;
					}
				} else {
					sibTop = $target.offset().top;
					if ( sibTop &lt; resTop ) {
						scrollTo = sibTop - resTop + $container.scrollTop();
					}
				}
				if ( scrollTo !== null ) {
					$container.scrollTop( scrollTo );
				}
			}
		},
		/**
		 * suggestion engine search
		 * @method search
		 * @param query {String}
		 * @param callback {Function} called after search is complete - args {Array of Results}
		 * @return {self}
		 */
		search: function( query, callback ) {
			var me = this;
			
			me._engine.query( query, callback );
			
			return me;
		},
		/**
		 * @method showResults
		 */
		showResults: function() {
			var me = this,
				$el = me.getElement(),
				$input = me.getInputEl(),
				$result = me.getResultEl(),
				query = $input.val().trim(),
				loader,
				item;

			if ( query.length &gt;= me.typeahead ) {
				$result.empty();
				
				$result.css({
					top: $el.offset().top + $el.outerHeight(),
					width: $el.outerWidth()
				});
				
				$result.show();
				
				me._resultsVisible = true;
				
				if ( me._engine.mode !== &quot;local&quot; ) {
					loader = Firebrick.create( &quot;Firebrick.ui.display.Loader&quot;, {
						target: $result
					});
				}

				//delay the search to allow the loader to be displayed
				Firebrick.delay(function() {
					me.search( query, function( results ) {
						var elements = [];
						if ( loader ) {
							loader.destroy();
						}
						if ( results ) {
							for ( var i = 0, l = results.length; i &lt; l; i++ ) {
								item = results[ i ];
								item.index = i;
								elements.push( me.renderItem( item ) );
							}

							$result.empty(); //remove loading
							$result.append( elements );
							
							//make sure scrolled at the top
							$result.scrollTop( 0 );
						
							me.fireEvent( &quot;expand&quot; );
						}
					});
				}, 10 );
			}
		},
		/**
		 * @method hideResults
		 */
		hideResults: function() {
			var me = this,
				$result = me.getResultEl();
			
			if ( me._resultsVisible ) {
				me._resultsVisible = false;
				$result.hide();
				me.fireEvent( &quot;collapse&quot; );
			}
		},
		/**
		 * @method renderChildren
		 * @param data {Object}
		 * @param scope {Object} optional
		 * @return {Array} jQuery elements
		 */
		renderChildren: function( data, scope ) {
			var me = this,
				items = [];
			if ( data.children ) {
				for ( var i = 0, l = data.children.length; i &lt; l; i++ ) {
					items.push( me.renderItem( data.children[ i ], scope ) );
				}
			}
			return items;
		},
		/**
		 * @method renderItem
		 * @param data {Object}
		 * @param scope {Object} optional
		 * @return {jQuery Object} element
		 */
		renderItem: function( data, scope ) {
			var me = this,
				prop = data.children ? &quot;groupTpl&quot; : &quot;itemTpl&quot;,
				$el;
			
			$el = me._renderItem( prop, data, scope );
			
			if ( data.children ) {
				$( &quot;.fb-ui-combo-group-children&quot;, $el ).html( me.renderChildren( data, scope ) );
			}
			
			return $el;
		},
		/**
		 * @method renderValueItem
		 * @param data {Object}
		 * @param scope {Object} optional
		 * @return {jQuery Object} element
		 */
		renderValueItem: function( data, scope ) {
			return this._renderItem( &quot;valueTpl&quot;, data, scope );
		},
		/**
		 * @method _renderItem
		 * @private
		 * @param tplProp {String} name of tpl property to use
		 * @param data {Object}
		 * @param scope {Object} optional
		 * @return {jQuery Object} html element
		 */
		_renderItem: function( tplProp, data, scope ) {
			var me = this,
				tpl = $.isFunction( me[ tplProp ] ) ? me[ tplProp ]() : me[ tplProp ];
			data._scope = data._scope || scope || me;
			if ( !me._itemTemplate[ tplProp ] ) {
				me._itemTemplate[ tplProp ] = tplEngine.template( tpl );
			}
			return $( me._itemTemplate[ tplProp ]( data ) ).prop( &quot;data-value&quot;, data );
		},
		/**
		 * @method bindings
		 */
		bindings: function() {
			var me = this,
				obj = me.callParent( arguments );
			
			obj.css[ &quot;&#x27;fb-ui-combobox&#x27;&quot; ] = true;
			
			if ( me.multiSelect ) {
				obj.css.multiple = true;
			} else {
				obj.css.single = true;
			}
			
			return obj;
		},
		/**
		 * @method valueBindings
		 */
		valueBindings: function() {
			var obj = {
					css: {
						&quot;&#x27;fb-ui-combo-values&#x27;&quot;: true
					}
				};
			
			return obj;
		},
		/**
		 * @method inputBindings
		 */
		inputBindings: function() {
			var obj = {
					css: {},
					attr: {
						autocomplete: true,
						tabindex: true
					}
				};
			
			obj.css[ &quot;&#x27;fb-ui-combo-input&#x27;&quot; ] = true;
			
			return obj;
		},
		/**
		 * @method clearIconBindings
		 */
		clearIconBindings: function() {
			var obj = {
					css: {
						glyphicon: true,
						&quot;&#x27;glyphicon-remove-circle&#x27;&quot;: true,
						&quot;&#x27;fb-ui-combo-clear-icon&#x27;&quot;: true
					}
				};
			
			return obj;
		},
		/**
		 * @method singleSelectBindings
		 */
		singleSelectBindings: function() {
			var me = this,
				obj = {
					css: {
						&quot;&#x27;fb-ui-combo-select&#x27;&quot;: true,
						caret: me.typeahead === 0 ? me.showCaret : false
					}
				};
			
			return obj;
		},
		/**
		 * @method resultBindings
		 */
		resultBindings: function() {
			var obj = {
					css: {
						&quot;&#x27;fb-ui-combo-result&#x27;&quot;: true
					}
				};
			
			return obj;
		},
		/**
		 * override
		 * @method _hasChange
		 * @param newVal {Any}
		 * @param oldVal {Any}
		 * @return {Boolean}
		 */
		_hasChange: function( newVal, oldVal ) {
			return !Firebrick.utils.compareArrays( newVal, oldVal );
		},
		/**
		 * @method getValue
		 * @return {Array}
		 */
		getValue: function() {
			var me = this,
				$vals = $( &quot;&gt; .fb-ui-combo-value-item&quot;, me.getValueEl() ),
				values = [],
				valKey = me.valueKey,
				val;
			
			for ( var i = 0, l = $vals.length; i &lt; l; i++ ) {
				val = $( $vals[ i ] ).prop( &quot;data-value&quot; );
				val = valKey ? val[ valKey ] : val;
				values.push( val );
			}
			
			return values;
		},
		/**
		 * @method setValues
		 * @param values {Array}
		 * @return parent
		 */
		setValue: function() {
			var me = this,
				$valueBox = me.getValueEl();
	
			if ( me.maxItems !== false ) {
				if ( $( &quot;.fb-ui-combo-value-item&quot;, $valueBox ).length === me.maxItems ) {
					//number of max items already reached
					return;
				}
			}
			
			return me.callParent( arguments );
		},
		/**
		 * @method _setValue
		 * @param value {Array}
		 * @private
		 */
		_setValue: function( values ) {
			var me = this,
				$valueBox = me.getValueEl(),
				$vals = [];
	
			if ( values.length ) {
				
				for ( var i = 0, l = values.length; i &lt; l; i++ ) {
					$vals.push( me.renderValueItem( values[ i ] ) );
				}
				
				if ( me.multiSelect ) {
					$valueBox.append( $vals );
				} else {
					$valueBox.html( $vals );
				}
				
				me.reset();
			}
			return me;
		}
	});
});

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
